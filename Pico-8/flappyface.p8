pico-8 cartridge // http://www.pico-8.com
version 29
__lua__
function _init()
game_over=false
make_cave()
make_player()
end

function _update()
if (not game_over) then
update_cave()
move_player()
check_hit()
end
end

function _draw()
cls()
draw_cave()
draw_player()
end
-->8
function make_player()
player={}
player.x=24
player.y=60
player.dy=0
player.rise=1
player.fall=2
player.dead=3
player.speed=2
player.score=0
end

function move_player()
gravity=0.2
player.dy+=gravity

if (btnp(2)) then
player.dy-=5
end

player.y+=player.dy
end

function draw_player()
if (game_over) then
spr(player.dead,player.x,player.y)
elseif (player.dy<0) then
spr(player.rise,player.x,player.y)
else
spr(player.fall,player.x,player.y)
end
end

function check_hit()
for i=player.x,player.x+7 do
if (cave[i+1].top>player.y
or cave[i+1].btm<player.y+7) then
game_over=true
end
end
end
-->8
function make_cave()
cave={{["top"]=5,["btm"]=119}}
top=45
btm=85
end

function update_cave()
if (#cave>player.speed) then
for i=1,player.speed do
del(cave,cave[1])
end
end

while (#cave<128) do
local col={}
local up=flr(rnd(7)-3)
local dwn=flr(rnd(7)-3)
col.top=mid(3,cave[#cave].top+up,top)
col.btm=mid(btm,cave[#cave].btm+dwn,124)
add(cave,col)
end
end

function draw_cave()
top_color=5
btm_color=5
for i=1,#cave do
line(i-1,0,i-1,cave[i].top,top_color)
line(i-1,127,i-1,cave[i].btm-btm_color)
end
end
__gfx__
00000000009aa700009aa70000288e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000009aaaa7009aaaa70028888e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
007007009a0aa0a79aaaaaa728888888000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000770009a0aa0aa9a0aa0aa28988988000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000770009aaaaaaa9aaaaaaa2c8888c8000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
007007009a0000aa9aa00aaac88988c8000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000009a00aa009a00aa002999980000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000009999000099990000229200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000007000000700000000e000000e000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000007111170071111700e888889000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000001119907011199700888090000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000101000001010000080809000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000800080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000d000000d0000000050000005000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000dd0000dd0000000055000055000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000dd1c1000dd1c1d0055e8e90000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000111990dd11199d00eee900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000505000d050500d05005090000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
